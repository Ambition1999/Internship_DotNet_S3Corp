@model UILayer.Models.ResetPasswordModel

@{
    ViewBag.Title = "ChangePassword";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link rel="stylesheet" href="~/Content/CSSFile/Now_LoginPageCSS.css">

<div class="container" id="container-resetpassword" style="justify-content:center; width:100%; height:300px; margin-top:100px">
    <h3>Tạo mật khẩu mới</h3>
    @using (Html.BeginForm("ResetPassword", "Account", FormMethod.Post, new { id = "form-2" }))
    {
        <div class="field-group" style="margin-bottom:5px">
            <div class="input-group">

                <input type="password" placeholder="New Password" id="new-password" name="new-password" style="line-height:30px; font-size:18px">
                <span class="form-message"></span>
            </div>
        </div>
        <div class="field-group" style="margin-bottom:5px">
            <div class="input-group">
                <input type="password" placeholder="Confirm Password" id="confirm-password" name="confirm-password" style="line-height:30px; font-size:18px">
                <span class="form-message"></span>
            </div>
        </div>
        <div class="field-group" style="margin-bottom:5px">
            <div class="input-group">
                @{
                    if (Model != null)
                    {
                        <input type="text" disabled placeholder="Your reset token code" id="reset-token" name="reset-token"
                               style="line-height:30px; font-size:18px" value="@Model.ResetToken">
                    }
                    else
                    {
                        <input type="text" disabled placeholder="Your reset token code" id="reset-token" name="reset-token" style="line-height:30px; font-size:18px" value="">
                    }
                }
                <span class="form-message"></span>
            </div>
        </div>
        <button class="btn btn-primary form-submit" type="submit">Đổi mật khẩu</button>
        <button class="btn btn-secondary" type="button" onclick="location.href='@Url.Action("Login","User")'">Quay về trang đăng nhập</button>
    }
</div>

<script src="~/Content/JsFile/ValidateForm.js"></script>
<script>
    Validator({
        form: '#form-2',
        errorSelector: '.form-message',
        rules: [
            Validator.isRequired('#new-password', "Vui lòng nhập mật khẩu mới"),
            Validator.minLength('#new-password',6,"Mật khẩu tối thiểu là 6 ký tự"),
            Validator.isConfirmed('#confirm-password', function () {
                return document.querySelector('#form-2 #new-password').value;
            }, "Mật khẩu nhập lại không trùng khớp"),
            Validator.isRequired('#reset-token', "Vui lòng nhập token"),
        ]
    })
</script>
<script>
        $.msg = function (text, style) {
            style = style || 'notice';

            $('<div>')
                .attr('class', style)
                .css({ "text-align": "center", "font-size": "20px", "color": "#ffff", "padding": "10px" })
                .html(text)
                .fadeIn('fast')
                .insertBefore($('#container-resetpassword'))
                .animate({ opacity: 1.0 }, 4000)
                .fadeOut('slow', function () {
                    $(this).remove();
                });
        };

        var message = '@TempData["SendEmailForgotPasswordMessage"]';
        var messageColor = '@TempData["SendEmailForgotPasswordMessageColor"]';
        if (message != null && message != "" && messageColor != null && messageColor != "") {
            $.msg(message, 'bg-' + messageColor)
        }
</script>
