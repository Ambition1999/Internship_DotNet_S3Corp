<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Now.vn</title>
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale = 1">
        <link rel="stylesheet" href="Now_layout_CSS.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <link rel="stylesheet" href="Now_LoginPageCSS.css">
        <link rel="stylesheet" href="Now_SignUpPageCSS.css">
        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>  
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    </head>
    <body>
        <div class="title">
            <h2><span>Create Acccount</span></h2>
        </div>
            <div class="login-form" id="form-1">
                <form>
                <div class="form-container">
                    <div class="field-group">
                        <div class="input-group">
                            <span class="name">Name:</span>
                            <input type="text" placeholder="Name" name="name" id="name">
                            <span class="form-message"></span>
                        </div>
                    </div>
                <div class="field-group">
                    <div class="input-group">
                        <span class="username">Username:</span>
                        <input type="text" placeholder="Username" name="username" id="username">
                        <span class="form-message" id="form-mesage-username"></span>
                    </div>
                </div>
                <div class="field-group">
                    <div class="input-group">
                        <span class="password">Password:</span>
                        <input type="password" placeholder="Password" name="password" id="password">
                        <span class="form-message"></span>
                    </div>
                </div>
                <div class="field-group">
                    <div class="input-group">
                        <span class="confirm-password">Confirm Password:</span>
                        <input type="password" placeholder="Confirm Password" name="confirm-password" id="confirm-password">
                        <span class="form-message"></span>
                    </div>
                </div>
                <div class="field-group">
                    <div class="input-group">
                        <span class="gender">Gender:</span>
                        <div class="gender-radio">
                            <div class="gender-box">
                                <input type="radio" checked="true" name="gender" id="male">
                                <label for="male">Male</label>
                            </div>
                            <div class="gender-box">
                                <input type="radio" name="gender" id="female">
                                <label for="female">Female</label>
                            </div>
                        </div>
                        <span class="form-message"></span>
                    </div>
                </div>
                <div class="field-group">
                    <div class="input-group">
                        <span class="Email">Email:</span>
                        <input type="text" placeholder="Email address" name="email" id="email">
                        <span class="form-message"></span>
                    </div>
                </div>
                <div class="field-group">
                    <div class="input-group">
                        <span class="phone-number">Phone:</span>
                        <input type="number" placeholder="Phone number" name="phone" id="phone">
                        <span class="form-message"></span>
                    </div>
                </div>
                <div class="field-group">
                    <div class="input-group">
                        <span class="birth-day">Birth Day:</span>
                        <input type="date">
                        <span class="form-message"></span>
                    </div>
                </div>
                <button class="btn btn-submit form-submit" disabled = "true" id="btn-submit" type="submit">Create</button>
            </div>
        </form>
        </div>
            <script src="./ValidateForm.js"></script>
        <script>
            Validator({
                form: '#form-1',
                errorSelector: '.form-message',
                rules: [
                    Validator.isRequired('#name'),
                    Validator.isRequired('#username'),
                    //Validator.isExist('#username','https://localhost:44325/api/UserAccount/UserNameIsExist/'),
                    Validator.isRequired('#password'),
                    Validator.minLength('#password',6,10, "Mật khẩu phải chứa từ 6 đến 10 kí tự"),
                    Validator.isRequired('#confirm-password'),
                    Validator.isConfirmed('#confirm-password', function(){
                        return document.querySelector('#form-1 #password').value;
                    }, "Mật khẩu nhập lại không chính xác"),
                    Validator.isRequired('#name'),
                    Validator.isEmail('#email'),
                    Validator.isRequired('#phone'),
                ],
                
            })
        </script>
        <script>
            $(function () {  
                $('#username').on("blur", function () {
                      
                    var username = $('#username').val();
                    if(username.trim())
                    {
                        var obj = { username: username };  
                        AjaxCall('https://localhost:44325/api/UserAccount/UserNameIsExist/'+username,null).done(function (response) {  
                            if (response === true) {  
                                $('#form-mesage-username').text("Tên đăng nhập đã được sử dụng, vui lòng chọn tên khác");
                                $('#form-mesage-username').parent(".input-group").addClass('invalid');
                            } 
                            else{
                                $('#form-mesage-username').text("");
                                $('#form-mesage-username').parent(".input-group").removeClass("invalid")
                            } 
                        }).fail(function (error) {  
                                alert(error.StatusText);  
                        });  
                    }
                });  
            });

            function AjaxCall(url, data, type) {  
                return $.ajax({  
                    url: url,  
                    type: type ? type : 'GET',  
                    data: data,  
                    contentType: 'application/json'  
                });  
            }
        </script>
    </body>
</html>